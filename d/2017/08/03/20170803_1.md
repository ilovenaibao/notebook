# vimloo class 重构计划
`+` `开发笔记` `vimloo`

原来的问题：
类、子类、对象，都用 copy() 函数复制大量键。
在表达需要大量结点对象的时候很浪费空间，使简单对象的存储也复杂化了。

优化思路：

* 功用上区分类对象与实例对象，类对象的一些属性不必要复制到实例中
* `_classkey_` 带两个下划线的键不复制到实例中，或称静态属性
* `protect_` 带一个下划线的键，不建议外部使用，也不必继承到子类中
* `class.vim` 通用基类文件中，尽量少定义方法，用 `class#helper` 全局函数实现内
  部细节管理。

继承概念梳理：

* `mother`，母类：单一母类，常规被继承的主要基类，一般包含数据与方法。
* `master`，师类：可额外学习多个方法，一般只有方法，类似 java 允许的多接口。
* `father`，父类：可额外继承的数据属性，可多个，但慎用

区分字典变量中的数据键与方法，以便管理类对象。

一般意义上只用到母类。从一个母类中生成对象。

对象的两种衍生，女儿是类，儿子是实例。

母类，师类，父类，皆针对实例而言。
实例只额外增加一个特殊属性 `_class_`，指向自己的母类（s:class）。
s:class 有三个属性 `_mother_`, `_master_`, `_father_`

2017-08-04:
基本完成，主要是改了 #new #ctor #old 方法
把原来的几个插件的类相关方法也改成新接口
vimloo 与 vnote 先在 dev 线上试行
tygame 与 startvim 只在 master
暂未提交 github ，观察下合 master 一起推送吧

1.5 用的 vim8 1.3 用的vim7.4
在 1.3 上测 vnote，发现 vim8 不再有 E706 类型不匹配的错误了。
要兼容 v7 特麻烦了

发现 old 继承方法，不能删去单 _ 下划线的键
vnote 已经有用过，而且子类继承的公有方法，可能会调用 _ 私有方法
必须复制下来

统一只把双下划线的删除，不复制到子类也不复制到子例。

2017-08-05:
将类定义中保存的 mother master father 信息从类名改成类字典引用。
增加时空效率，同时可能支持非单独文件的定义类。

将 module/less 的纯方法模块改写到 class/less ，但暂未删原有的。
import 名字改为 export

2017-08-07:
周末在家重新组织了一下类结构。增加了 `s:class._object_` 长子概念，
class#use 引入包记录功能。

2017-08-10:
补完文档，准备更新至主干提交。
